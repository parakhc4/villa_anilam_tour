<krpano>
	<action name="silence_errors">
		set(showerrors, false);
		set(debugmode, false);
		set(logkey.enabled, false);
		set(keycode_192.enabled, false);
		set(keycode_76.enabled, false);
		set(plugin[log].visible, false);
		removelayer(log);
	</action>
    <action name="init_flags">
		set(music_is_playing, false);
		set(is_animating, false);
	</action>
	
	<action name="preload_music">
		js('var audio = new Audio("%SWFPATH%/music/background.mp3"); audio.load();');
	</action>
	<!-- When Clicking Enter button, make it dissapear -->
	<action name="hide_welcome_layer_natural">
		tween(layer[welcome_layer].alpha, 0, 0.5, easeOutSine,
			removelayer(welcome_layer);
		);
	</action>
	<!-- Toggle the sidebar -->
	<action name="toggle_sidebar">
		if(is_animating, null,
			set(is_animating, true);
			if(layer[sidebar].visible,
				tween(layer[sidebar].x, -250, 0.5);
				tween(layer[menu_button].x, 10, 0.5);
				delayedcall(0.5, 
					set(layer[sidebar].visible, false);
					set(is_animating, false);
				);
			,
				set(layer[sidebar].visible, true);
				tween(layer[sidebar].x, 0, 0.5);
				tween(layer[menu_button].x, 250, 0.5);
				delayedcall(0.5,
					set(is_animating, false);
				);
			);
		);
	</action>
	<!-- Toggle Dropdown -->
	<action name="toggle_dropdown_set_list">
		<!-- Params:
			 %1 = dropdown label layer (e.g., dropdown1)
			 %2 = comma-separated list of layers to toggle (e.g., "btn1,btn2,sep1,sep2")
		-->
	
		<!-- Extract the first button from list to check visibility -->
		set(first_item, getarray(%2, 0));
	
		if(layer[get(first_item)].visible,
			set(layer[%1].html, 'GROUND FLOOR ▼');
	
			for(set(i, 0), i LT calc(array.count(%2)), inc(i),
				set(name, getarray(%2, i));
				set(layer[get(name)].visible, false);
			);
		,
			set(layer[%1].html, 'GROUND FLOOR ▲');
	
			for(set(i, 0), i LT calc(array.count(%2)), inc(i),
				set(name, getarray(%2, i));
				set(layer[get(name)].visible, true);
			);
		);
	</action>

	<action name="toggle_groundfloor_dropdown">
		if(layer[dropdown1button1].visible,
			set(layer[dropdown1].html, 'GROUND FLOOR ▼');
			set(layer[dropdown1button1].visible, false);
			set(layer[dropdown1button2].visible, false);
			set(layer[dropdown1button3].visible, false);
			set(layer[dropdown1button4].visible, false);
			set(layer[dropdown1button5].visible, false);
			set(layer[dropdown1button6].visible, false);
			set(layer[dropdown1separator1].visible, false);
			set(layer[dropdown1separator2].visible, false);
			set(layer[dropdown1separator3].visible, false);
			set(layer[dropdown1separator4].visible, false);
			set(layer[dropdown1separator5].visible, false);
			set(layer[dropdown1separator6].visible, false);
			
		,
			set(layer[dropdown1].html, 'GROUND FLOOR ▲');
			set(layer[dropdown1button1].visible, true);
			set(layer[dropdown1button2].visible, true);
			set(layer[dropdown1button3].visible, true);
			set(layer[dropdown1button4].visible, true);
			set(layer[dropdown1button5].visible, true);
			set(layer[dropdown1button6].visible, true);
			set(layer[dropdown1separator1].visible, true);
			set(layer[dropdown1separator2].visible, true);
			set(layer[dropdown1separator3].visible, true);
			set(layer[dropdown1separator4].visible, true);
			set(layer[dropdown1separator5].visible, true);
			set(layer[dropdown1separator6].visible, true);
		);
	</action>
	
	
	
	
</krpano>